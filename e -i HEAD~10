[33mcommit 7002d8efa0740e1f200d3748f0d7a8e8bafa5c8b[m[33m ([m[1;32mfix-secrets[m[33m)[m
Author: Krhrystyna3004 <khrystynanovak3004@gmail.com>
Date:   Sun Jan 18 18:17:25 2026 +0200

    Ð¾Ð½Ð¾Ð²Ð¸Ð»Ð° Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð¸Ñ…

[1mdiff --git a/AddConfig.cs b/AddConfig.cs[m
[1mnew file mode 100644[m
[1mindex 0000000..ce775bb[m
[1m--- /dev/null[m
[1m+++ b/AddConfig.cs[m
[36m@@ -0,0 +1,8 @@[m
[32m+[m[32mï»¿namespace SecureNotes[m
[32m+[m[32m{[m
[32m+[m[32m    public static class AppConfig[m
[32m+[m[32m    {[m
[32m+[m[32m        public static readonly string ConnStr =[m
[32m+[m[32m            "Server=securenotes1-khrystynanovak3004-69ca.c.aivencloud.com;Port=13671;Database=defaultdb;Uid=avnadmin;Pwd=AVNS_-kPIV_WilR-2bbifil7;SslMode=Required;";[m
[32m+[m[32m    }[m
[32m+[m[32m}[m
\ No newline at end of file[m
[1mdiff --git a/App.config b/App.config[m
[1mdeleted file mode 100644[m
[1mindex 193aecc..0000000[m
[1m--- a/App.config[m
[1m+++ /dev/null[m
[36m@@ -1,6 +0,0 @@[m
[31m-ï»¿<?xml version="1.0" encoding="utf-8" ?>[m
[31m-<configuration>[m
[31m-    <startup> [m
[31m-        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.8" />[m
[31m-    </startup>[m
[31m-</configuration>[m
\ No newline at end of file[m
[1mdiff --git a/DatabaseHelper.cs b/DatabaseHelper.cs[m
[1mindex c47ba31..81441c9 100644[m
[1m--- a/DatabaseHelper.cs[m
[1m+++ b/DatabaseHelper.cs[m
[36m@@ -1,394 +1,334 @@[m
 ï»¿using System;[m
 using System.Collections.Generic;[m
[31m-using System.Data.SQLite;[m
[31m-using System.IO;[m
[32m+[m[32musing MySql.Data.MySqlClient;[m
[32m+[m[32musing Microsoft.Extensions.Configuration;[m
 [m
 namespace SecureNotes[m
 {[m
     public class DatabaseHelper[m
     {[m
[31m-        private readonly string _dbPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "notes.db");[m
         private readonly string _cs;[m
 [m
[32m+[m[32m        // ÐšÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€ Ð±ÐµÐ· Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ–Ð²: Ð±ÐµÑ€Ðµ Ñ€ÑÐ´Ð¾Ðº Ð¿Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ Ð· appsettings.json + Ð·Ð¼Ñ–Ð½Ð½Ð¸Ñ… ÑÐµÑ€ÐµÐ´Ð¾Ð²Ð¸Ñ‰Ð°[m
         public DatabaseHelper()[m
         {[m
[31m-            _cs = $"Data Source={_dbPath};Version=3;";[m
[31m-            EnsureDatabase();[m
[32m+[m[32m            var config = new Microsoft.Extensions.Configuration.ConfigurationBuilder()[m
[32m+[m[32m                .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)[m
[32m+[m[32m                .AddJsonFile("appsettings.Development.json", optional: true, reloadOnChange: true)[m
[32m+[m[32m                .AddEnvironmentVariables()[m
[32m+[m[32m                .Build();[m
[32m+[m
[32m+[m[32m            _cs = config.GetConnectionString("DefaultConnection");[m
         }[m
 [m
[31m-        private void EnsureDatabase()[m
[32m+[m[32m        // ÐšÐ¾Ð½ÑÑ‚Ñ€ÑƒÐºÑ‚Ð¾Ñ€ Ð· Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð¼: Ð¼Ð¾Ð¶Ð½Ð° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚Ð¸ Ñ€ÑÐ´Ð¾Ðº Ð²Ñ€ÑƒÑ‡Ð½Ñƒ[m
[32m+[m[32m        public DatabaseHelper(string connStr)[m
         {[m
[31m-            if (!File.Exists(_dbPath)) SQLiteConnection.CreateFile(_dbPath);[m
[31m-[m
[31m-            using (var conn = new SQLiteConnection(_cs))[m
[31m-            {[m
[31m-                conn.Open();[m
[31m-[m
[31m-                string users = @"CREATE TABLE IF NOT EXISTS Users ([m
[31m-Id INTEGER PRIMARY KEY AUTOINCREMENT,[m
[31m-Username TEXT UNIQUE NOT NULL,[m
[31m-PasswordHash TEXT NOT NULL,[m
[31m-PasswordSalt TEXT NOT NULL,[m
[31m-PinHash TEXT,[m
[31m-PinSalt TEXT,[m
[31m-PreferredTheme TEXT DEFAULT 'Light',[m
[31m-CreatedAt DATETIME DEFAULT CURRENT_TIMESTAMP[m
[31m-);";[m
[31m-[m
[31m-                string notes = @"CREATE TABLE IF NOT EXISTS Notes ([m
[31m-Id INTEGER PRIMARY KEY AUTOINCREMENT,[m
[31m-OwnerId INTEGER NOT NULL,[m
[31m-GroupId INTEGER,[m
[31m-Title TEXT NOT NULL,[m
[31m-Content TEXT NOT NULL,[m
[31m-Type TEXT NOT NULL,[m
[31m-Color TEXT,[m
[31m-Tags TEXT,[m
[31m-IvBase64 TEXT,[m
[31m-CreatedAt DATETIME DEFAULT CURRENT_TIMESTAMP,[m
[31m-UpdatedAt DATETIME DEFAULT CURRENT_TIMESTAMP[m
[31m-);";[m
[31m-[m
[31m-                string groups = @"CREATE TABLE IF NOT EXISTS Groups ([m
[31m-Id INTEGER PRIMARY KEY AUTOINCREMENT,[m
[31m-OwnerId INTEGER NOT NULL,[m
[31m-InviteCode TEXT UNIQUE NOT NULL,[m
[31m-Name TEXT,[m
[31m-CreatedAt DATETIME DEFAULT CURRENT_TIMESTAMP[m
[31m-);";[m
[31m-[m
[31m-                string members = @"CREATE TABLE IF NOT EXISTS GroupMembers ([m
[31m-Id INTEGER PRIMARY KEY AUTOINCREMENT,[m
[31m-GroupId INTEGER NOT NULL,[m
[31m-UserId INTEGER NOT NULL,[m
[31m-Permission TEXT NOT NULL[m
[31m-);";[m
[31m-[m
[31m-                using (var cmd = new SQLiteCommand(users, conn)) cmd.ExecuteNonQuery();[m
[31m-                using (var cmd = new SQLiteCommand(notes, conn)) cmd.ExecuteNonQuery();[m
[31m-                using (var cmd = new SQLiteCommand(groups, conn)) cmd.ExecuteNonQuery();[m
[31m-                using (var cmd = new SQLiteCommand(members, conn)) cmd.ExecuteNonQuery();[m
[31m-            }[m
[32m+[m[32m            _cs = connStr;[m
         }[m
 [m
[31m-        // Users[m
[32m+[m[32m        public MySqlConnection GetConnection() => new MySqlConnection(_cs);[m
[32m+[m
[32m+[m[32m        // ---------------- USERS ----------------[m
         public User GetUserByUsername(string username)[m
         {[m
[31m-            using (var conn = new SQLiteConnection(_cs))[m
[32m+[m[32m            using var conn = GetConnection();[m
[32m+[m[32m            conn.Open();[m
[32m+[m[32m            var cmd = new MySqlCommand("SELECT * FROM users WHERE Username=@u", conn);[m
[32m+[m[32m            cmd.Parameters.AddWithValue("@u", username);[m
[32m+[m[32m            using var r = cmd.ExecuteReader();[m
[32m+[m[32m            if (!r.Read()) return null;[m
[32m+[m
[32m+[m[32m            return new User[m
             {[m
[31m-                conn.Open();[m
[31m-                using (var cmd = new SQLiteCommand("SELECT Id, Username, PasswordHash, PasswordSalt, PinHash, PinSalt, PreferredTheme, CreatedAt FROM Users WHERE Username=@u", conn))[m
[31m-                {[m
[31m-                    cmd.Parameters.AddWithValue("@u", username);[m
[31m-                    using (var r = cmd.ExecuteReader())[m
[31m-                    {[m
[31m-                        if (!r.Read()) return null;[m
[31m-                        return new User[m
[31m-                        {[m
[31m-                            Id = r.GetInt32(0),[m
[31m-                            Username = r.GetString(1),[m
[31m-                            PasswordHash = r.GetString(2),[m
[31m-                            PasswordSalt = r.GetString(3),[m
[31m-                            PinHash = r.IsDBNull(4) ? "" : r.GetString(4),[m
[31m-                            PinSalt = r.IsDBNull(5) ? "" : r.GetString(5),[m
[31m-                            PreferredTheme = r.IsDBNull(6) ? "Light" : r.GetString(6),[m
[31m-                            CreatedAt = DateTime.Parse(r.GetString(7))[m
[31m-                        };[m
[31m-                    }[m
[31m-                }[m
[31m-            }[m
[32m+[m[32m                Id = r.GetInt32("Id"),[m
[32m+[m[32m                Username = r.GetString("Username"),[m
[32m+[m[32m                PasswordHash = r.GetString("PasswordHash"),[m
[32m+[m[32m                PasswordSalt = r.GetString("PasswordSalt"),[m
[32m+[m[32m                PinHash = r.IsDBNull(r.GetOrdinal("PinHash")) ? null : r.GetString("PinHash"),[m
[32m+[m[32m                PinSalt = r.IsDBNull(r.GetOrdinal("PinSalt")) ? null : r.GetString("PinSalt"),[m
[32m+[m[32m                PreferredTheme = r.IsDBNull(r.GetOrdinal("PreferredTheme")) ? "Light" : r.GetString("PreferredTheme"),[m
[32m+[m[32m                CreatedAt = r.GetDateTime("CreatedAt")[m
[32m+[m[32m            };[m
         }[m
 [m
         public int CreateUser(User u)[m
         {[m
[31m-            using (var 